"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const api_1 = require("../../api");
const msw_1 = require("msw");
const node_1 = require("msw/node");
const assert_1 = require("assert");
const pkg = require("../../../../package.json");
const channel_access_token = "test_channel_access_token";
describe("MessagingApiBlobClient", () => {
    const server = (0, node_1.setupServer)();
    before(() => {
        server.listen();
    });
    after(() => {
        server.close();
    });
    afterEach(() => {
        server.resetHandlers();
    });
    const client = new api_1.MessagingApiBlobClient({
        channelAccessToken: channel_access_token,
    });
    it("getMessageContent", async () => {
        let requestCount = 0;
        const endpoint = "https://api-data.line.me/v2/bot/message/{messageId}/content".replace("{messageId}", "DUMMY"); // string
        server.use(msw_1.http.get(endpoint, ({ request, params, cookies }) => {
            requestCount++;
            (0, assert_1.equal)(request.headers.get("Authorization"), `Bearer ${channel_access_token}`);
            (0, assert_1.equal)(request.headers.get("User-Agent"), `${pkg.name}/${pkg.version}`);
            return msw_1.HttpResponse.json({});
        }));
        const res = await client.getMessageContent(
        // messageId: string
        "DUMMY");
        (0, assert_1.equal)(requestCount, 1);
    });
    it("getMessageContentPreview", async () => {
        let requestCount = 0;
        const endpoint = "https://api-data.line.me/v2/bot/message/{messageId}/content/preview".replace("{messageId}", "DUMMY"); // string
        server.use(msw_1.http.get(endpoint, ({ request, params, cookies }) => {
            requestCount++;
            (0, assert_1.equal)(request.headers.get("Authorization"), `Bearer ${channel_access_token}`);
            (0, assert_1.equal)(request.headers.get("User-Agent"), `${pkg.name}/${pkg.version}`);
            return msw_1.HttpResponse.json({});
        }));
        const res = await client.getMessageContentPreview(
        // messageId: string
        "DUMMY");
        (0, assert_1.equal)(requestCount, 1);
    });
    it("getMessageContentTranscodingByMessageId", async () => {
        let requestCount = 0;
        const endpoint = "https://api-data.line.me/v2/bot/message/{messageId}/content/transcoding".replace("{messageId}", "DUMMY"); // string
        server.use(msw_1.http.get(endpoint, ({ request, params, cookies }) => {
            requestCount++;
            (0, assert_1.equal)(request.headers.get("Authorization"), `Bearer ${channel_access_token}`);
            (0, assert_1.equal)(request.headers.get("User-Agent"), `${pkg.name}/${pkg.version}`);
            return msw_1.HttpResponse.json({});
        }));
        const res = await client.getMessageContentTranscodingByMessageId(
        // messageId: string
        "DUMMY");
        (0, assert_1.equal)(requestCount, 1);
    });
    it("getRichMenuImage", async () => {
        let requestCount = 0;
        const endpoint = "https://api-data.line.me/v2/bot/richmenu/{richMenuId}/content".replace("{richMenuId}", "DUMMY"); // string
        server.use(msw_1.http.get(endpoint, ({ request, params, cookies }) => {
            requestCount++;
            (0, assert_1.equal)(request.headers.get("Authorization"), `Bearer ${channel_access_token}`);
            (0, assert_1.equal)(request.headers.get("User-Agent"), `${pkg.name}/${pkg.version}`);
            return msw_1.HttpResponse.json({});
        }));
        const res = await client.getRichMenuImage(
        // richMenuId: string
        "DUMMY");
        (0, assert_1.equal)(requestCount, 1);
    });
    it("setRichMenuImage", async () => {
        let requestCount = 0;
        const endpoint = "https://api-data.line.me/v2/bot/richmenu/{richMenuId}/content".replace("{richMenuId}", "DUMMY"); // string
        server.use(msw_1.http.post(endpoint, ({ request, params, cookies }) => {
            requestCount++;
            (0, assert_1.equal)(request.headers.get("Authorization"), `Bearer ${channel_access_token}`);
            (0, assert_1.equal)(request.headers.get("User-Agent"), `${pkg.name}/${pkg.version}`);
            return msw_1.HttpResponse.json({});
        }));
        const res = await client.setRichMenuImage(
        // richMenuId: string
        "DUMMY", // richMenuId(string)
        // body: Blob
        new Blob([]));
        (0, assert_1.equal)(requestCount, 1);
    });
});
